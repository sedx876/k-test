{"ast":null,"code":"var _jsxFileName = \"/Users/sharonwatkins/Desktop/Code/kline/client/src/pages/Shop.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { getProductsByCount, fetchProductsByFilter } from \"../functions/product\";\nimport { getCategories } from \"../functions/category\";\nimport { getSubs } from \"../functions/sub\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport ProductCard from \"../components/cards/ProductCard\";\nimport { Menu, Slider, Checkbox, Radio } from \"antd\";\nimport { DollarOutlined, DownSquareOutlined, StarOutlined } from \"@ant-design/icons\";\nimport Star from \"../components/forms/Star\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst {\n  SubMenu,\n  ItemGroup\n} = Menu;\n\nconst Shop = () => {\n  _s();\n\n  const [products, setProducts] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [price, setPrice] = useState([0, 0]);\n  const [ok, setOk] = useState(false);\n  const [categories, setCategories] = useState([]);\n  const [categoryIds, setCategoryIds] = useState([]);\n  const [star, setStar] = useState(\"\");\n  const [subs, setSubs] = useState([]);\n  const [sub, setSub] = useState(\"\");\n  const [brands, setBrands] = useState([\"Apple\", \"Samsung\", \"Microsoft\", \"Lenovo\", \"ASUS\"]);\n  const [brand, setBrand] = useState(\"\");\n  const [colors, setColors] = useState([\"Black\", \"Brown\", \"Silver\", \"White\", \"Blue\"]);\n  const [color, setColor] = useState(\"\");\n  const [shipping, setShipping] = useState(\"\");\n  let dispatch = useDispatch();\n  let {\n    search\n  } = useSelector(state => ({ ...state\n  }));\n  const {\n    text\n  } = search;\n  useEffect(() => {\n    loadAllProducts(); // fetch categories\n\n    getCategories().then(res => setCategories(res.data)); // fetch subcategories\n\n    getSubs().then(res => setSubs(res.data));\n  }, []);\n\n  const fetchProducts = arg => {\n    fetchProductsByFilter(arg).then(res => {\n      setProducts(res.data);\n    });\n  }; // 1. load products by default on page load\n\n\n  const loadAllProducts = () => {\n    getProductsByCount(12).then(p => {\n      setProducts(p.data);\n      setLoading(false);\n    });\n  }; // 2. load products on user search input\n\n\n  useEffect(() => {\n    const delayed = setTimeout(() => {\n      fetchProducts({\n        query: text\n      });\n\n      if (!text) {\n        loadAllProducts();\n      }\n    }, 300);\n    return () => clearTimeout(delayed);\n  }, [text]); // 3. load products based on price range\n\n  useEffect(() => {\n    console.log(\"ok to request\");\n    fetchProducts({\n      price\n    });\n  }, [ok]);\n\n  const handleSlider = value => {\n    dispatch({\n      type: \"SEARCH_QUERY\",\n      payload: {\n        text: \"\"\n      }\n    }); // reset\n\n    setCategoryIds([]);\n    setPrice(value);\n    setStar(\"\");\n    setSub(\"\");\n    setBrand(\"\");\n    setColor(\"\");\n    setShipping(\"\");\n    setTimeout(() => {\n      setOk(!ok);\n    }, 300);\n  }; // 4. load products based on category\n  // show categories in a list of checkbox\n\n\n  const showCategories = () => categories.map(c => /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Checkbox, {\n      onChange: handleCheck,\n      className: \"pb-2 pl-4 pr-4\",\n      value: c._id,\n      name: \"category\",\n      checked: categoryIds.includes(c._id),\n      children: c.name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 9\n    }, this)]\n  }, c._id, true, {\n    fileName: _jsxFileName,\n    lineNumber: 114,\n    columnNumber: 7\n  }, this)); // handle check for categories\n\n\n  const handleCheck = e => {\n    // reset\n    dispatch({\n      type: \"SEARCH_QUERY\",\n      payload: {\n        text: \"\"\n      }\n    });\n    setPrice([0, 0]);\n    setStar(\"\");\n    setSub(\"\");\n    setBrand(\"\");\n    setColor(\"\");\n    setShipping(\"\"); // console.log(e.target.value);\n\n    let inTheState = [...categoryIds];\n    let justChecked = e.target.value;\n    let foundInTheState = inTheState.indexOf(justChecked); // index or -1\n    // indexOf method ?? if not found returns -1 else return index [1,2,3,4,5]\n\n    if (foundInTheState === -1) {\n      inTheState.push(justChecked);\n    } else {\n      // if found pull out one item from index\n      inTheState.splice(foundInTheState, 1);\n    }\n\n    setCategoryIds(inTheState); // console.log(inTheState);\n\n    fetchProducts({\n      category: inTheState\n    });\n  }; // 5. show products by star rating\n\n\n  const handleStarClick = num => {\n    // console.log(num);\n    dispatch({\n      type: \"SEARCH_QUERY\",\n      payload: {\n        text: \"\"\n      }\n    });\n    setPrice([0, 0]);\n    setCategoryIds([]);\n    setStar(num);\n    setSub(\"\");\n    setBrand(\"\");\n    setColor(\"\");\n    setShipping(\"\");\n    fetchProducts({\n      stars: num\n    });\n  };\n\n  const showStars = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"pr-4 pl-4 pb-2\",\n    children: [/*#__PURE__*/_jsxDEV(Star, {\n      starClick: handleStarClick,\n      numberOfStars: 5\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Star, {\n      starClick: handleStarClick,\n      numberOfStars: 4\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Star, {\n      starClick: handleStarClick,\n      numberOfStars: 3\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Star, {\n      starClick: handleStarClick,\n      numberOfStars: 2\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Star, {\n      starClick: handleStarClick,\n      numberOfStars: 1\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 177,\n    columnNumber: 5\n  }, this); // 6. show products by sub category\n\n\n  const showSubs = () => subs.map(s => /*#__PURE__*/_jsxDEV(\"div\", {\n    onClick: () => handleSub(s),\n    className: \"p-1 m-1 badge badge-secondary\",\n    style: {\n      cursor: \"pointer\"\n    },\n    children: s.name\n  }, s._id, false, {\n    fileName: _jsxFileName,\n    lineNumber: 189,\n    columnNumber: 7\n  }, this));\n\n  const handleSub = sub => {\n    // console.log(\"SUB\", sub);\n    setSub(sub);\n    dispatch({\n      type: \"SEARCH_QUERY\",\n      payload: {\n        text: \"\"\n      }\n    });\n    setPrice([0, 0]);\n    setCategoryIds([]);\n    setStar(\"\");\n    setBrand(\"\");\n    setColor(\"\");\n    setShipping(\"\");\n    fetchProducts({\n      sub\n    });\n  }; // 7. show products based on brand name\n\n\n  const showBrands = () => brands.map(b => /*#__PURE__*/_jsxDEV(Radio, {\n    value: b,\n    name: b,\n    checked: b === brand,\n    onChange: handleBrand,\n    className: \"pb-1 pl-4 pr-4\",\n    children: b\n  }, b, false, {\n    fileName: _jsxFileName,\n    lineNumber: 218,\n    columnNumber: 7\n  }, this));\n\n  const handleBrand = e => {\n    setSub(\"\");\n    dispatch({\n      type: \"SEARCH_QUERY\",\n      payload: {\n        text: \"\"\n      }\n    });\n    setPrice([0, 0]);\n    setCategoryIds([]);\n    setStar(\"\");\n    setColor(\"\");\n    setBrand(e.target.value);\n    setShipping(\"\");\n    fetchProducts({\n      brand: e.target.value\n    });\n  }; // 8. show products based on color\n\n\n  const showColors = () => colors.map(c => /*#__PURE__*/_jsxDEV(Radio, {\n    value: c,\n    name: c,\n    checked: c === color,\n    onChange: handleColor,\n    className: \"pb-1 pl-4 pr-4\",\n    children: c\n  }, c, false, {\n    fileName: _jsxFileName,\n    lineNumber: 248,\n    columnNumber: 7\n  }, this));\n\n  const handleColor = e => {\n    setSub(\"\");\n    dispatch({\n      type: \"SEARCH_QUERY\",\n      payload: {\n        text: \"\"\n      }\n    });\n    setPrice([0, 0]);\n    setCategoryIds([]);\n    setStar(\"\");\n    setBrand(\"\");\n    setColor(e.target.value);\n    setShipping(\"\");\n    fetchProducts({\n      color: e.target.value\n    });\n  }; // 9. show products based on shipping yes/no\n\n\n  const showShipping = () => /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Checkbox, {\n      className: \"pb-2 pl-4 pr-4\",\n      onChange: handleShippingchange,\n      value: \"Yes\",\n      checked: shipping === \"Yes\",\n      children: \"Yes\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Checkbox, {\n      className: \"pb-2 pl-4 pr-4\",\n      onChange: handleShippingchange,\n      value: \"No\",\n      checked: shipping === \"No\",\n      children: \"No\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n\n  const handleShippingchange = e => {\n    setSub(\"\");\n    dispatch({\n      type: \"SEARCH_QUERY\",\n      payload: {\n        text: \"\"\n      }\n    });\n    setPrice([0, 0]);\n    setCategoryIds([]);\n    setStar(\"\");\n    setBrand(\"\");\n    setColor(\"\");\n    setShipping(e.target.value);\n    fetchProducts({\n      shipping: e.target.value\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container-fluid\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-3 pt-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Search/Filter\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 318,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Menu, {\n          defaultOpenKeys: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\"],\n          mode: \"inline\",\n          children: [/*#__PURE__*/_jsxDEV(SubMenu, {\n            title: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"h6\",\n              children: [/*#__PURE__*/_jsxDEV(DollarOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 329,\n                columnNumber: 19\n              }, this), \" Price\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 328,\n              columnNumber: 17\n            }, this),\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(Slider, {\n                className: \"ml-4 mr-4\",\n                tipFormatter: v => `$${v}`,\n                range: true,\n                value: price,\n                onChange: handleSlider,\n                max: \"100000\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 334,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 333,\n              columnNumber: 15\n            }, this)\n          }, \"1\", false, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(SubMenu, {\n            title: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"h6\",\n              children: [/*#__PURE__*/_jsxDEV(DownSquareOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 350,\n                columnNumber: 19\n              }, this), \" Categories\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 349,\n              columnNumber: 17\n            }, this),\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                maringTop: \"-10px\"\n              },\n              children: showCategories()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 354,\n              columnNumber: 15\n            }, this)\n          }, \"2\", false, {\n            fileName: _jsxFileName,\n            lineNumber: 346,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(SubMenu, {\n            title: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"h6\",\n              children: [/*#__PURE__*/_jsxDEV(StarOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 362,\n                columnNumber: 19\n              }, this), \" Rating\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 17\n            }, this),\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                maringTop: \"-10px\"\n              },\n              children: showStars()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 366,\n              columnNumber: 15\n            }, this)\n          }, \"3\", false, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(SubMenu, {\n            title: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"h6\",\n              children: [/*#__PURE__*/_jsxDEV(DownSquareOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 374,\n                columnNumber: 19\n              }, this), \" Sub Categories\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 373,\n              columnNumber: 17\n            }, this),\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                maringTop: \"-10px\"\n              },\n              className: \"pl-4 pr-4\",\n              children: showSubs()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 378,\n              columnNumber: 15\n            }, this)\n          }, \"4\", false, {\n            fileName: _jsxFileName,\n            lineNumber: 370,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(SubMenu, {\n            title: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"h6\",\n              children: [/*#__PURE__*/_jsxDEV(DownSquareOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 388,\n                columnNumber: 19\n              }, this), \" Brands\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 387,\n              columnNumber: 17\n            }, this),\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                maringTop: \"-10px\"\n              },\n              className: \"pr-5\",\n              children: showBrands()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 392,\n              columnNumber: 15\n            }, this)\n          }, \"5\", false, {\n            fileName: _jsxFileName,\n            lineNumber: 384,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(SubMenu, {\n            title: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"h6\",\n              children: [/*#__PURE__*/_jsxDEV(DownSquareOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 402,\n                columnNumber: 19\n              }, this), \" Colors\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 401,\n              columnNumber: 17\n            }, this),\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                maringTop: \"-10px\"\n              },\n              className: \"pr-5\",\n              children: showColors()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 406,\n              columnNumber: 15\n            }, this)\n          }, \"6\", false, {\n            fileName: _jsxFileName,\n            lineNumber: 398,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(SubMenu, {\n            title: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"h6\",\n              children: [/*#__PURE__*/_jsxDEV(DownSquareOutlined, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 416,\n                columnNumber: 19\n              }, this), \" Shipping\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 415,\n              columnNumber: 17\n            }, this),\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                maringTop: \"-10px\"\n              },\n              className: \"pr-5\",\n              children: showShipping()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 420,\n              columnNumber: 15\n            }, this)\n          }, \"7\", false, {\n            fileName: _jsxFileName,\n            lineNumber: 412,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-9 pt-2\",\n        children: [loading ? /*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"text-danger\",\n          children: \"Loading...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-danger text-center\",\n          style: {\n            textDecoration: \"underline\"\n          },\n          children: \"Products\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 13\n        }, this), products.length < 1 && /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"No products found\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 438,\n          columnNumber: 35\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row pb-5\",\n          children: products.map(p => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-md-4 mt-3\",\n            children: /*#__PURE__*/_jsxDEV(ProductCard, {\n              product: p\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 443,\n              columnNumber: 17\n            }, this)\n          }, p._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 442,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 314,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Shop, \"YWFGid/y7Wf3PVT6LaKr0EvXz64=\", false, function () {\n  return [useDispatch, useSelector];\n});\n\n_c = Shop;\nexport default Shop;\n\nvar _c;\n\n$RefreshReg$(_c, \"Shop\");","map":{"version":3,"sources":["/Users/sharonwatkins/Desktop/Code/kline/client/src/pages/Shop.js"],"names":["React","useState","useEffect","getProductsByCount","fetchProductsByFilter","getCategories","getSubs","useSelector","useDispatch","ProductCard","Menu","Slider","Checkbox","Radio","DollarOutlined","DownSquareOutlined","StarOutlined","Star","SubMenu","ItemGroup","Shop","products","setProducts","loading","setLoading","price","setPrice","ok","setOk","categories","setCategories","categoryIds","setCategoryIds","star","setStar","subs","setSubs","sub","setSub","brands","setBrands","brand","setBrand","colors","setColors","color","setColor","shipping","setShipping","dispatch","search","state","text","loadAllProducts","then","res","data","fetchProducts","arg","p","delayed","setTimeout","query","clearTimeout","console","log","handleSlider","value","type","payload","showCategories","map","c","handleCheck","_id","includes","name","e","inTheState","justChecked","target","foundInTheState","indexOf","push","splice","category","handleStarClick","num","stars","showStars","showSubs","s","handleSub","cursor","showBrands","b","handleBrand","showColors","handleColor","showShipping","handleShippingchange","v","maringTop","textDecoration","length"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  getProductsByCount,\n  fetchProductsByFilter,\n} from \"../functions/product\";\nimport { getCategories } from \"../functions/category\";\nimport { getSubs } from \"../functions/sub\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport ProductCard from \"../components/cards/ProductCard\";\nimport { Menu, Slider, Checkbox, Radio } from \"antd\";\nimport {\n  DollarOutlined,\n  DownSquareOutlined,\n  StarOutlined,\n} from \"@ant-design/icons\";\nimport Star from \"../components/forms/Star\";\n\nconst { SubMenu, ItemGroup } = Menu;\n\nconst Shop = () => {\n  const [products, setProducts] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [price, setPrice] = useState([0, 0]);\n  const [ok, setOk] = useState(false);\n  const [categories, setCategories] = useState([]);\n  const [categoryIds, setCategoryIds] = useState([]);\n  const [star, setStar] = useState(\"\");\n  const [subs, setSubs] = useState([]);\n  const [sub, setSub] = useState(\"\");\n  const [brands, setBrands] = useState([\n    \"Apple\",\n    \"Samsung\",\n    \"Microsoft\",\n    \"Lenovo\",\n    \"ASUS\",\n  ]);\n  const [brand, setBrand] = useState(\"\");\n  const [colors, setColors] = useState([\n    \"Black\",\n    \"Brown\",\n    \"Silver\",\n    \"White\",\n    \"Blue\",\n  ]);\n  const [color, setColor] = useState(\"\");\n  const [shipping, setShipping] = useState(\"\");\n\n  let dispatch = useDispatch();\n  let { search } = useSelector((state) => ({ ...state }));\n  const { text } = search;\n\n  useEffect(() => {\n    loadAllProducts();\n    // fetch categories\n    getCategories().then((res) => setCategories(res.data));\n    // fetch subcategories\n    getSubs().then((res) => setSubs(res.data));\n  }, []);\n\n  const fetchProducts = (arg) => {\n    fetchProductsByFilter(arg).then((res) => {\n      setProducts(res.data);\n    });\n  };\n\n  // 1. load products by default on page load\n  const loadAllProducts = () => {\n    getProductsByCount(12).then((p) => {\n      setProducts(p.data);\n      setLoading(false);\n    });\n  };\n\n  // 2. load products on user search input\n  useEffect(() => {\n    const delayed = setTimeout(() => {\n      fetchProducts({ query: text });\n      if (!text) {\n        loadAllProducts();\n      }\n    }, 300);\n    return () => clearTimeout(delayed);\n  }, [text]);\n\n  // 3. load products based on price range\n  useEffect(() => {\n    console.log(\"ok to request\");\n    fetchProducts({ price });\n  }, [ok]);\n\n  const handleSlider = (value) => {\n    dispatch({\n      type: \"SEARCH_QUERY\",\n      payload: { text: \"\" },\n    });\n\n    // reset\n    setCategoryIds([]);\n    setPrice(value);\n    setStar(\"\");\n    setSub(\"\");\n    setBrand(\"\");\n    setColor(\"\");\n    setShipping(\"\");\n    setTimeout(() => {\n      setOk(!ok);\n    }, 300);\n  };\n\n  // 4. load products based on category\n  // show categories in a list of checkbox\n  const showCategories = () =>\n    categories.map((c) => (\n      <div key={c._id}>\n        <Checkbox\n          onChange={handleCheck}\n          className=\"pb-2 pl-4 pr-4\"\n          value={c._id}\n          name=\"category\"\n          checked={categoryIds.includes(c._id)}\n        >\n          {c.name}\n        </Checkbox>\n        <br />\n      </div>\n    ));\n\n  // handle check for categories\n  const handleCheck = (e) => {\n    // reset\n    dispatch({\n      type: \"SEARCH_QUERY\",\n      payload: { text: \"\" },\n    });\n    setPrice([0, 0]);\n    setStar(\"\");\n    setSub(\"\");\n    setBrand(\"\");\n    setColor(\"\");\n    setShipping(\"\");\n    // console.log(e.target.value);\n    let inTheState = [...categoryIds];\n    let justChecked = e.target.value;\n    let foundInTheState = inTheState.indexOf(justChecked); // index or -1\n\n    // indexOf method ?? if not found returns -1 else return index [1,2,3,4,5]\n    if (foundInTheState === -1) {\n      inTheState.push(justChecked);\n    } else {\n      // if found pull out one item from index\n      inTheState.splice(foundInTheState, 1);\n    }\n\n    setCategoryIds(inTheState);\n    // console.log(inTheState);\n    fetchProducts({ category: inTheState });\n  };\n\n  // 5. show products by star rating\n  const handleStarClick = (num) => {\n    // console.log(num);\n    dispatch({\n      type: \"SEARCH_QUERY\",\n      payload: { text: \"\" },\n    });\n    setPrice([0, 0]);\n    setCategoryIds([]);\n    setStar(num);\n    setSub(\"\");\n    setBrand(\"\");\n    setColor(\"\");\n    setShipping(\"\");\n    fetchProducts({ stars: num });\n  };\n\n  const showStars = () => (\n    <div className=\"pr-4 pl-4 pb-2\">\n      <Star starClick={handleStarClick} numberOfStars={5} />\n      <Star starClick={handleStarClick} numberOfStars={4} />\n      <Star starClick={handleStarClick} numberOfStars={3} />\n      <Star starClick={handleStarClick} numberOfStars={2} />\n      <Star starClick={handleStarClick} numberOfStars={1} />\n    </div>\n  );\n\n  // 6. show products by sub category\n  const showSubs = () =>\n    subs.map((s) => (\n      <div\n        key={s._id}\n        onClick={() => handleSub(s)}\n        className=\"p-1 m-1 badge badge-secondary\"\n        style={{ cursor: \"pointer\" }}\n      >\n        {s.name}\n      </div>\n    ));\n\n  const handleSub = (sub) => {\n    // console.log(\"SUB\", sub);\n    setSub(sub);\n    dispatch({\n      type: \"SEARCH_QUERY\",\n      payload: { text: \"\" },\n    });\n    setPrice([0, 0]);\n    setCategoryIds([]);\n    setStar(\"\");\n    setBrand(\"\");\n    setColor(\"\");\n    setShipping(\"\");\n    fetchProducts({ sub });\n  };\n\n  // 7. show products based on brand name\n  const showBrands = () =>\n    brands.map((b) => (\n      <Radio\n        key={b}\n        value={b}\n        name={b}\n        checked={b === brand}\n        onChange={handleBrand}\n        className=\"pb-1 pl-4 pr-4\"\n      >\n        {b}\n      </Radio>\n    ));\n\n  const handleBrand = (e) => {\n    setSub(\"\");\n    dispatch({\n      type: \"SEARCH_QUERY\",\n      payload: { text: \"\" },\n    });\n    setPrice([0, 0]);\n    setCategoryIds([]);\n    setStar(\"\");\n    setColor(\"\");\n    setBrand(e.target.value);\n    setShipping(\"\");\n    fetchProducts({ brand: e.target.value });\n  };\n\n  // 8. show products based on color\n  const showColors = () =>\n    colors.map((c) => (\n      <Radio\n        key={c}\n        value={c}\n        name={c}\n        checked={c === color}\n        onChange={handleColor}\n        className=\"pb-1 pl-4 pr-4\"\n      >\n        {c}\n      </Radio>\n    ));\n\n  const handleColor = (e) => {\n    setSub(\"\");\n    dispatch({\n      type: \"SEARCH_QUERY\",\n      payload: { text: \"\" },\n    });\n    setPrice([0, 0]);\n    setCategoryIds([]);\n    setStar(\"\");\n    setBrand(\"\");\n    setColor(e.target.value);\n    setShipping(\"\");\n    fetchProducts({ color: e.target.value });\n  };\n\n  // 9. show products based on shipping yes/no\n  const showShipping = () => (\n    <>\n      <Checkbox\n        className=\"pb-2 pl-4 pr-4\"\n        onChange={handleShippingchange}\n        value=\"Yes\"\n        checked={shipping === \"Yes\"}\n      >\n        Yes\n      </Checkbox>\n\n      <Checkbox\n        className=\"pb-2 pl-4 pr-4\"\n        onChange={handleShippingchange}\n        value=\"No\"\n        checked={shipping === \"No\"}\n      >\n        No\n      </Checkbox>\n    </>\n  );\n\n  const handleShippingchange = (e) => {\n    setSub(\"\");\n    dispatch({\n      type: \"SEARCH_QUERY\",\n      payload: { text: \"\" },\n    });\n    setPrice([0, 0]);\n    setCategoryIds([]);\n    setStar(\"\");\n    setBrand(\"\");\n    setColor(\"\");\n    setShipping(e.target.value);\n    fetchProducts({ shipping: e.target.value });\n  };\n\n  return (\n    <div className=\"container-fluid\">\n      <div className=\"row\">\n        <div className=\"col-md-3 pt-2\">\n          <h4>Search/Filter</h4>\n          <hr />\n\n          <Menu\n            defaultOpenKeys={[\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\"]}\n            mode=\"inline\"\n          >\n            {/* price */}\n            <SubMenu\n              key=\"1\"\n              title={\n                <span className=\"h6\">\n                  <DollarOutlined /> Price\n                </span>\n              }\n            >\n              <div>\n                <Slider\n                  className=\"ml-4 mr-4\"\n                  tipFormatter={(v) => `$${v}`}\n                  range\n                  value={price}\n                  onChange={handleSlider}\n                  max=\"100000\"\n                />\n              </div>\n            </SubMenu>\n\n            {/* category */}\n            <SubMenu\n              key=\"2\"\n              title={\n                <span className=\"h6\">\n                  <DownSquareOutlined /> Categories\n                </span>\n              }\n            >\n              <div style={{ maringTop: \"-10px\" }}>{showCategories()}</div>\n            </SubMenu>\n\n            {/* stars */}\n            <SubMenu\n              key=\"3\"\n              title={\n                <span className=\"h6\">\n                  <StarOutlined /> Rating\n                </span>\n              }\n            >\n              <div style={{ maringTop: \"-10px\" }}>{showStars()}</div>\n            </SubMenu>\n\n            {/* sub category */}\n            <SubMenu\n              key=\"4\"\n              title={\n                <span className=\"h6\">\n                  <DownSquareOutlined /> Sub Categories\n                </span>\n              }\n            >\n              <div style={{ maringTop: \"-10px\" }} className=\"pl-4 pr-4\">\n                {showSubs()}\n              </div>\n            </SubMenu>\n\n            {/* brands */}\n            <SubMenu\n              key=\"5\"\n              title={\n                <span className=\"h6\">\n                  <DownSquareOutlined /> Brands\n                </span>\n              }\n            >\n              <div style={{ maringTop: \"-10px\" }} className=\"pr-5\">\n                {showBrands()}\n              </div>\n            </SubMenu>\n\n            {/* colors */}\n            <SubMenu\n              key=\"6\"\n              title={\n                <span className=\"h6\">\n                  <DownSquareOutlined /> Colors\n                </span>\n              }\n            >\n              <div style={{ maringTop: \"-10px\" }} className=\"pr-5\">\n                {showColors()}\n              </div>\n            </SubMenu>\n\n            {/* shipping */}\n            <SubMenu\n              key=\"7\"\n              title={\n                <span className=\"h6\">\n                  <DownSquareOutlined /> Shipping\n                </span>\n              }\n            >\n              <div style={{ maringTop: \"-10px\" }} className=\"pr-5\">\n                {showShipping()}\n              </div>\n            </SubMenu>\n          </Menu>\n        </div>\n\n        <div className=\"col-md-9 pt-2\">\n          {loading ? (\n            <h4 className=\"text-danger\">Loading...</h4>\n          ) : (\n            <h1 \n              className=\"text-danger text-center\"\n              style={{textDecoration: \"underline\"}}>\n                Products\n            </h1>\n          )}\n\n          {products.length < 1 && <p>No products found</p>}\n\n          <div className=\"row pb-5\">\n            {products.map((p) => (\n              <div key={p._id} className=\"col-md-4 mt-3\">\n                <ProductCard product={p} />\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Shop"]},"metadata":{},"sourceType":"module"}